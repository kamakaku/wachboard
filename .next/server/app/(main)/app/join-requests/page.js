(()=>{var e={};e.id=485,e.ids=[485],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},37932:(e,a,s)=>{"use strict";s.r(a),s.d(a,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>o}),s(24739),s(88834),s(41611),s(35866),s(32029);var t=s(23191),r=s(88716),i=s(37922),n=s.n(i),d=s(95231),l={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);s.d(a,l);let o=["",{children:["(main)",{children:["app",{children:["join-requests",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,24739)),"/Users/kamakaku/_desiqn/__wachboard/src/app/(main)/app/join-requests/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,88834)),"/Users/kamakaku/_desiqn/__wachboard/src/app/(main)/app/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,41611)),"/Users/kamakaku/_desiqn/__wachboard/src/app/(main)/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,32029)),"/Users/kamakaku/_desiqn/__wachboard/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/kamakaku/_desiqn/__wachboard/src/app/(main)/app/join-requests/page.tsx"],m="/(main)/app/join-requests/page",p={require:s,loadChunk:()=>Promise.resolve()},u=new t.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(main)/app/join-requests/page",pathname:"/app/join-requests",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},28064:(e,a,s)=>{Promise.resolve().then(s.bind(s,87148))},87148:(e,a,s)=>{"use strict";s.d(a,{JoinRequestApprovalForm:()=>m});var t=s(10326),r=s(17577),i=s(91664),n=s(9280),d=s(44794),l=s(29280),o=s(24118),c=s(53863);function m({requestId:e,divisions:a}){let[s,m]=(0,r.useState)(!1),[p,u]=(0,r.useState)("VIEWER"),[x,f]=(0,r.useState)([]),[h,j]=(0,r.useState)(!1),g=e=>{f(a=>a.includes(e)?a.filter(a=>a!==e):[...a,e])},b=async a=>{a.preventDefault(),j(!0);let s=new FormData;s.append("requestId",e),s.append("role",p),s.append("divisionIds",x.join(",")),await (0,c.Gr)(s)};return(0,t.jsxs)(o.Dialog,{open:s,onOpenChange:m,children:[t.jsx(o.DialogTrigger,{asChild:!0,children:t.jsx(i.z,{variant:"default",size:"sm",children:"Akzeptieren"})}),(0,t.jsxs)(o.DialogContent,{children:[(0,t.jsxs)(o.DialogHeader,{children:[t.jsx(o.DialogTitle,{children:"Beitrittsanfrage akzeptieren"}),t.jsx(o.DialogDescription,{children:"W\xe4hlen Sie die Rolle und optional die Divisionen f\xfcr diesen Benutzer."})]}),(0,t.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[t.jsx(d.Label,{htmlFor:"role",children:"Rolle"}),(0,t.jsxs)(l.Ph,{value:p,onValueChange:u,children:[t.jsx(l.i4,{id:"role",children:t.jsx(l.ki,{})}),(0,t.jsxs)(l.Bw,{children:[t.jsx(l.Ql,{value:"VIEWER",children:"Viewer (nur lesen)"}),t.jsx(l.Ql,{value:"EDITOR",children:"Editor (Dienstpl\xe4ne bearbeiten)"}),t.jsx(l.Ql,{value:"ADMIN",children:"Admin (volle Kontrolle)"})]})]})]}),"EDITOR"===p&&a.length>0&&(0,t.jsxs)("div",{children:[t.jsx(d.Label,{children:"Divisionen (f\xfcr Editor)"}),t.jsx("div",{className:"space-y-2 mt-2 max-h-[200px] overflow-y-auto border rounded p-3",children:a.map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[t.jsx(n.X,{id:`division-${e.id}`,checked:x.includes(e.id),onCheckedChange:()=>g(e.id)}),t.jsx(d.Label,{htmlFor:`division-${e.id}`,className:"text-sm font-normal cursor-pointer",children:e.name})]},e.id))}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"W\xe4hlen Sie die Divisionen, die dieser Editor verwalten darf."})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[t.jsx(i.z,{type:"button",variant:"outline",onClick:()=>m(!1),disabled:h,children:"Abbrechen"}),t.jsx(i.z,{type:"submit",disabled:h,children:h?"Wird akzeptiert...":"Akzeptieren"})]})]})]})]})}},9280:(e,a,s)=>{"use strict";s.d(a,{X:()=>l});var t=s(10326),r=s(17577),i=s(13635),n=s(32933),d=s(51223);let l=r.forwardRef(({className:e,...a},s)=>t.jsx(i.fC,{ref:s,className:(0,d.cn)("grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...a,children:t.jsx(i.z$,{className:(0,d.cn)("grid place-content-center text-current"),children:t.jsx(n.Z,{className:"h-4 w-4"})})}));l.displayName=i.fC.displayName},24118:(e,a,s)=>{"use strict";s.d(a,{Dialog:()=>l,DialogContent:()=>p,DialogDescription:()=>h,DialogFooter:()=>x,DialogHeader:()=>u,DialogTitle:()=>f,DialogTrigger:()=>o});var t=s(10326),r=s(17577),i=s(37956),n=s(94019),d=s(51223);let l=i.fC,o=i.xz,c=i.h_;i.x8;let m=r.forwardRef(({className:e,...a},s)=>t.jsx(i.aV,{ref:s,className:(0,d.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...a}));m.displayName=i.aV.displayName;let p=r.forwardRef(({className:e,children:a,...s},r)=>(0,t.jsxs)(c,{children:[t.jsx(m,{}),(0,t.jsxs)(i.VY,{ref:r,className:(0,d.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg max-h-[90vh] translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg overflow-hidden",e),...s,children:[t.jsx("div",{className:"flex flex-col gap-4 overflow-y-auto pr-1 max-h-[80vh]",children:a}),(0,t.jsxs)(i.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[t.jsx(n.Z,{className:"h-4 w-4"}),t.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));p.displayName=i.VY.displayName;let u=({className:e,...a})=>t.jsx("div",{className:(0,d.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...a});u.displayName="DialogHeader";let x=({className:e,...a})=>t.jsx("div",{className:(0,d.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...a});x.displayName="DialogFooter";let f=r.forwardRef(({className:e,...a},s)=>t.jsx(i.Dx,{ref:s,className:(0,d.cn)("text-lg font-semibold leading-none tracking-tight",e),...a}));f.displayName=i.Dx.displayName;let h=r.forwardRef(({className:e,...a},s)=>t.jsx(i.dk,{ref:s,className:(0,d.cn)("text-sm text-muted-foreground",e),...a}));h.displayName=i.dk.displayName},44794:(e,a,s)=>{"use strict";s.d(a,{Label:()=>o});var t=s(10326),r=s(17577),i=s(29152),n=s(79360),d=s(51223);let l=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=r.forwardRef(({className:e,...a},s)=>t.jsx(i.f,{ref:s,className:(0,d.cn)(l(),e),...a}));o.displayName=i.f.displayName},29280:(e,a,s)=>{"use strict";s.d(a,{Bw:()=>f,Ph:()=>c,Ql:()=>h,i4:()=>p,ki:()=>m});var t=s(10326),r=s(17577),i=s(42437),n=s(941),d=s(96633),l=s(32933),o=s(51223);let c=i.fC;i.ZA;let m=i.B4,p=r.forwardRef(({className:e,children:a,...s},r)=>(0,t.jsxs)(i.xz,{ref:r,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...s,children:[a,t.jsx(i.JO,{asChild:!0,children:t.jsx(n.Z,{className:"h-4 w-4 opacity-50"})})]}));p.displayName=i.xz.displayName;let u=r.forwardRef(({className:e,...a},s)=>t.jsx(i.u_,{ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",e),...a,children:t.jsx(d.Z,{className:"h-4 w-4"})}));u.displayName=i.u_.displayName;let x=r.forwardRef(({className:e,...a},s)=>t.jsx(i.$G,{ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",e),...a,children:t.jsx(n.Z,{className:"h-4 w-4"})}));x.displayName=i.$G.displayName;let f=r.forwardRef(({className:e,children:a,position:s="popper",...r},n)=>t.jsx(i.h_,{children:(0,t.jsxs)(i.VY,{ref:n,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:s,...r,children:[t.jsx(u,{}),t.jsx(i.l_,{className:(0,o.cn)("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),t.jsx(x,{})]})}));f.displayName=i.VY.displayName,r.forwardRef(({className:e,...a},s)=>t.jsx(i.__,{ref:s,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...a})).displayName=i.__.displayName;let h=r.forwardRef(({className:e,children:a,...s},r)=>(0,t.jsxs)(i.ck,{ref:r,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...s,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(i.wU,{children:t.jsx(l.Z,{className:"h-4 w-4"})})}),t.jsx(i.eT,{children:a})]}));h.displayName=i.ck.displayName,r.forwardRef(({className:e,...a},s)=>t.jsx(i.Z0,{ref:s,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",e),...a})).displayName=i.Z0.displayName},53863:(e,a,s)=>{"use strict";s.d(a,{Gr:()=>i,nB:()=>r}),s(15424);var t=s(46242),r=(0,t.$)("952f7879cdccaeee0d550ce745157068cc57c2fa");(0,t.$)("935a02ff5ad3f32514a031e75fad6c1a300ce60f"),(0,t.$)("cb7bd06c1d01ccb171f3a399726de42085eec918"),(0,t.$)("64819fdbf6747c9de70c4f6c789726e25ed33dab");var i=(0,t.$)("7718239856a5ecd6b6dd9302e4f387114b4eed56");(0,t.$)("4ca3e45e59d17eb24834057aa663cd58822f0362")},24739:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>m});var t=s(19510),r=s(27039),i=s(93804),n=s(75782),d=s(65655),l=s(58585);let o=(0,s(68570).createProxy)(String.raw`/Users/kamakaku/_desiqn/__wachboard/src/components/admin/join-request-approval-form.tsx#JoinRequestApprovalForm`);var c=s(66561);async function m({searchParams:e}){let a=(0,d.e)(),{data:{user:s}}=await a.auth.getUser();s||(0,l.redirect)("/login");let{data:m}=await a.from("memberships").select("station_id, role").eq("user_id",s.id).single();if(!m||"ADMIN"!==m.role)return t.jsx("div",{className:"py-8 px-6",children:(0,t.jsxs)(i.Zb,{className:"border-destructive",children:[t.jsx(i.Ol,{children:t.jsx(i.ll,{children:"Zugriff verweigert"})}),t.jsx(i.aY,{children:t.jsx("p",{children:"Sie ben\xf6tigen Administrator-Rechte."})})]})});let{data:p}=await a.from("join_requests").select("*, user:users_profile(id, email, name)").eq("station_id",m.station_id).eq("status","PENDING").order("created_at",{ascending:!1}),{data:u}=await a.from("divisions").select("id, name").eq("station_id",m.station_id).order("name",{ascending:!0});return(0,t.jsxs)("div",{className:"py-8 px-6",children:[t.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Beitrittsanfragen"}),e.error&&t.jsx(i.Zb,{className:"mb-6 border-destructive",children:t.jsx(i.aY,{className:"pt-6",children:t.jsx("p",{className:"text-destructive",children:e.error})})}),e.success&&t.jsx(i.Zb,{className:"mb-6 border-green-500",children:t.jsx(i.aY,{className:"pt-6",children:t.jsx("p",{className:"text-green-600",children:e.success})})}),(0,t.jsxs)(i.Zb,{children:[(0,t.jsxs)(i.Ol,{children:[t.jsx(i.ll,{children:"Ausstehende Anfragen"}),(0,t.jsxs)(i.SZ,{children:["Benutzer, die Ihrer Wache beitreten m\xf6chten (",p?.length||0," ","ausstehend)"]})]}),t.jsx(i.aY,{children:p&&p.length>0?(0,t.jsxs)(n.iA,{children:[t.jsx(n.xD,{children:(0,t.jsxs)(n.SC,{children:[t.jsx(n.ss,{children:"Benutzer"}),t.jsx(n.ss,{children:"Angefragt am"}),t.jsx(n.ss,{children:"Aktionen"})]})}),t.jsx(n.RM,{children:p.map(e=>(0,t.jsxs)(n.SC,{children:[t.jsx(n.pj,{children:(0,t.jsxs)("div",{children:[t.jsx("p",{className:"font-medium",children:e.user?.name||"Unbekannt"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:e.user?.email})]})}),t.jsx(n.pj,{children:new Date(e.created_at).toLocaleDateString("de-DE")}),t.jsx(n.pj,{children:(0,t.jsxs)("div",{className:"flex gap-2",children:[t.jsx(o,{requestId:e.id,divisions:u||[]}),(0,t.jsxs)("form",{action:c.rejectJoinRequest,children:[t.jsx("input",{type:"hidden",name:"requestId",value:e.id}),t.jsx(r.z,{type:"submit",variant:"outline",size:"sm",className:"text-destructive",children:"Ablehnen"})]})]})})]},e.id))})]}):t.jsx("div",{className:"text-center py-8",children:t.jsx("p",{className:"text-muted-foreground",children:"Keine ausstehenden Beitrittsanfragen."})})})]})]})}}};var a=require("../../../../webpack-runtime.js");a.C(e);var s=e=>a(a.s=e),t=a.X(0,[276,374,702,582,559,369,4,52,273,863,698],()=>s(37932));module.exports=t})();