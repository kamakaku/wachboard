"use strict";(()=>{var e={};e.id=707,e.ids=[707],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},57869:(e,s,i)=>{i.r(s),i.d(s,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>h,pages:()=>o,routeModule:()=>m,tree:()=>c}),i(2303),i(88834),i(41611),i(35866),i(32029);var a=i(23191),t=i(88716),r=i(37922),n=i.n(r),d=i(95231),l={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);i.d(s,l);let c=["",{children:["(main)",{children:["app",{children:["shifts",{children:["new",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(i.bind(i,2303)),"/Users/kamakaku/_desiqn/__wachboard/src/app/(main)/app/shifts/new/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(i.bind(i,88834)),"/Users/kamakaku/_desiqn/__wachboard/src/app/(main)/app/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(i.bind(i,41611)),"/Users/kamakaku/_desiqn/__wachboard/src/app/(main)/layout.tsx"],"not-found":[()=>Promise.resolve().then(i.t.bind(i,35866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(i.bind(i,32029)),"/Users/kamakaku/_desiqn/__wachboard/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(i.t.bind(i,35866,23)),"next/dist/client/components/not-found-error"]}],o=["/Users/kamakaku/_desiqn/__wachboard/src/app/(main)/app/shifts/new/page.tsx"],h="/(main)/app/shifts/new/page",p={require:i,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/(main)/app/shifts/new/page",pathname:"/app/shifts/new",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},2303:(e,s,i)=>{i.r(s),i.d(s,{default:()=>x});var a=i(19510),t=i(65655),r=i(58585),n=i(57371),d=i(27039),l=i(93804),c=i(49922),o=i(40278),h=i(39755),p=i(36974),m=i(25544),u=i(36523);async function x({searchParams:e}){let s=(0,t.e)(),{data:{user:i}}=await s.auth.getUser();i||(0,r.redirect)("/login");let{data:x}=await s.from("memberships").select("station_id, role, division_ids").eq("user_id",i.id).single();if(!x||!["ADMIN","EDITOR"].includes(x.role))return a.jsx("div",{className:"py-8 px-6",children:(0,a.jsxs)(l.Zb,{className:"border-destructive",children:[a.jsx(l.Ol,{children:a.jsx(l.ll,{children:"Zugriff verweigert"})}),a.jsx(l.aY,{children:a.jsx("p",{children:"Sie ben\xf6tigen Editor- oder Administrator-Rechte."})})]})});let f=s.from("divisions").select("*").eq("station_id",x.station_id);"EDITOR"===x.role&&x.division_ids&&x.division_ids.length>0&&(f=f.in("id",x.division_ids));let{data:_}=await f.order("name",{ascending:!0}),{data:g}=await s.from("vehicle_configs").select("*").eq("station_id",x.station_id).order("order",{ascending:!0}),{data:j}=await s.from("people").select("*").eq("station_id",x.station_id).eq("active",!0).order("name",{ascending:!0}),{data:b}=await s.from("shift_templates").select("*").eq("station_id",x.station_id).order("label",{ascending:!0});return(0,a.jsxs)("div",{className:"py-8 px-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[a.jsx(n.default,{href:"/app/shifts",children:(0,a.jsxs)(d.z,{variant:"ghost",size:"sm",className:"mb-4",children:[a.jsx(h.Z,{className:"h-4 w-4 mr-2"}),"Zur\xfcck zur \xdcbersicht"]})}),a.jsx("h1",{className:"text-3xl font-bold",children:"Neue Schicht erstellen"}),a.jsx("p",{className:"text-muted-foreground",children:"Erstellen Sie einen Dienstplan f\xfcr eine Schicht und weisen Sie Personal zu"})]}),e.error&&a.jsx(l.Zb,{className:"mb-6 border-destructive",children:(0,a.jsxs)(l.aY,{className:"pt-6",children:[a.jsx("p",{className:"text-destructive mb-3",children:e.error}),e.error.includes("existiert bereits")&&a.jsx(n.default,{href:"/app/shifts",children:a.jsx(d.z,{variant:"outline",size:"sm",children:"Zur Schicht-\xdcbersicht"})})]})}),e.success&&a.jsx(l.Zb,{className:"mb-6 border-green-500",children:a.jsx(l.aY,{className:"pt-6",children:a.jsx("p",{className:"text-green-600",children:e.success})})}),(0,a.jsxs)("form",{action:u.createShift,className:"space-y-6",children:[(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{children:[a.jsx(l.ll,{children:"Schicht-Details"}),a.jsx(l.SZ,{children:"Grundlegende Informationen zur Schicht"})]}),(0,a.jsxs)(l.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[a.jsx(o._,{htmlFor:"shift-date",children:"Datum *"}),a.jsx(c.I,{id:"shift-date",name:"date",type:"date",required:!0,defaultValue:new Date().toISOString().split("T")[0]})]}),a.jsx(m.V,{templates:b||[]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[a.jsx(o._,{htmlFor:"shift-division",children:"Wachabteilung *"}),(0,a.jsxs)("select",{id:"shift-division",name:"division_id",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background",required:!0,children:[a.jsx("option",{value:"",children:"W\xe4hlen Sie eine Wachabteilung"}),_?.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"wachleitung-im-haus",name:"wachleitung_im_haus",className:"h-4 w-4 rounded border-gray-300"}),a.jsx(o._,{htmlFor:"wachleitung-im-haus",className:"text-sm font-normal cursor-pointer",children:"Wachleitung im Haus"})]})]})]}),a.jsx(p.s,{vehicles:g||[],people:j||[],divisions:_||[]}),(0,a.jsxs)("div",{className:"flex gap-4 justify-end",children:[a.jsx(n.default,{href:"/app/shifts",children:a.jsx(d.z,{type:"button",variant:"outline",children:"Abbrechen"})}),a.jsx(d.z,{type:"submit",children:"Schicht erstellen"})]})]})]})}}};var s=require("../../../../../webpack-runtime.js");s.C(e);var i=e=>s(s.s=e),a=s.X(0,[276,374,702,582,559,369,4,226,101,863,916],()=>i(57869));module.exports=a})();